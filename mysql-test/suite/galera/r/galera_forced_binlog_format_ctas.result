connection node_2;
connection node_1;
CREATE TABLE t1(a int not null primary key, b int) ENGINE=InnoDB;
CREATE TABLE t2(a int not null primary key, b int) ENGINE=InnoDB;
INSERT INTO t1 SELECT seq,seq from seq_1_to_1000;
CREATE TABLE t3 AS SELECT * FROM t1;
CREATE TABLE t4 AS SELECT * FROM t2;
CREATE TABLE t5 (a INT UNIQUE) AS SELECT 1 AS a;
CREATE TABLE t6 (a INT UNIQUE) REPLACE SELECT 1 AS a;
CREATE TABLE t7 (a INT UNIQUE) REPLACE SELECT 1 AS a,2 AS b UNION SELECT 1 AS a,3 AS c;
SELECT COUNT(*) AS EXPECT_1000 FROM t1;
EXPECT_1000
1000
SELECT COUNT(*) AS EXPECT_0 FROM t2;
EXPECT_0
0
SELECT COUNT(*) AS EXPECT_1000 FROM t3;
EXPECT_1000
1000
SELECT * FROM t4;
a	b
SELECT * FROM t5;
a
1
SELECT * FROM t6;
a
1
SELECT * FROM t7;
a	b
1	3
connection node_2;
# Veryfy CTAS replication
SELECT COUNT(*) AS EXPECT_1000 FROM t1;
EXPECT_1000
1000
SELECT COUNT(*) AS EXPECT_0 FROM t2;
EXPECT_0
0
SELECT COUNT(*) AS EXPECT_1000 FROM t3;
EXPECT_1000
1000
SELECT * FROM t4;
a	b
SELECT * FROM t5;
a
1
SELECT * FROM t6;
a
1
SELECT * FROM t7;
a	b
1	3
connection node_1;
DROP TABLE t1,t2,t3,t4,t5,t6,t7;
